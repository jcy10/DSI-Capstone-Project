# DSI Capstone Project: Building a Movie Recommendation Engine
By: Yeo Jia Chi (General Assembly Singapore - DSI 11)

Please visit (https://yeojiachi.wixsite.com/home/capstone)

## Problem Statement:
The use of internet movie review databases such as RottenTomatoes.com and IMDB.com, have been extremely useful in helping movie viewers to decide if a particular film title is worth watching. However, as these resources are static in nature, the usefulness of such websites in providing potential film recommendations rely heavily on users actively searching and knowing what they are looking for.

Not only is this manual movie selection process uninteresting and repeative, more than often than not, movies which rate highly may not actually cater to the viewer's interests. For instance, a very highly rated science-fiction film that had won several Academy Awards, is likely to be passed over if the user is searching for a romantic comedy. Likewise, a user who constantly watches popular and highly-rated films, may lose the serendipidous discovery and enjoyment of new movie genres and unknown film titles.

To bridge this gap and provide an engaging customer experience, popular streaming providers like Youtube, Netflix and Amazon Videos have deployed machine learning algorithms to predict new video recommendations which their users may enjoy. Unfortunately, the use of such tools for movie recommendations are currently limited to: a) only their hosted video content, and b) for movies which have completed their theatrical release (i.e. no longer showing in cinemas).

As a movie fan who frequently goes to the cinema, the lack of any recommender system which includes both past and presently screening film titles leaves something to be desired. Therefore in this capstone project, I will be attempting to build a user personalized movie recommendation engine by incorporating each movie critic's review as explicit feedback. Finally, this model will be deployed online to allow for users to access the list of movie recommendations generated by this machine learning model.

## Executive Summary:
Contents:
1) Problem Statement
2) Executive Summary
3) Importing the Libraries
4) Webscraping critic scores from RottenTomatoes.com
5) Data Cleaning
6) Data Supplementation
7) Exploratory Data Analysis (EDA)
8) Data Modelling
9) Model Tuning
10) Model Evaluation
11) Creating NMF Model Ver 2.0
12) Enrolling New Users
13) Populating our recsys_user dictionary with the RottenTomatoes critics
14) Final Testing
15) Model Deployment
16) Conclusion and Recommendations

## Data Dictionary
For the compiled RottenTomatoes/MovieLens/IMDB Database, the data dictionary is as follows:

|Feature|Description|Source|
|:---------------|-------------------------------------------------------|------------------------|
|**title_year**|Combined feature from "title" + "year_released"|Engineered feature|
|**title**|The movie title|RottenTomatoes.com|
|**year_released**|The year the movie was released|RottenTomatoes.com|
|**rt_score**|The aggregate movie score given by RottenTomatoes.com|RottenTomatoes.com|
|**critic_score**|The movie score given by the particular movie critic|RottenTomatoes.com|
|**norm_critic_score**|The critic's movie score normalized from a scale of 0-5|Engineered feature|
|**movie_review**|The critic's written opinion about the movie|RottenTomatoes.com|
|**critic_name**|The critic's name|RottenTomatoes.com|
|**review_pub_date**|The date this movie review was published|RottenTomatoes.com|
|**review_pub_loc**|The location where this movie review was published|RottenTomatoes.com|
|**critic_rt_url**|The critic's RottenTomatoes URL|RottenTomatoes.com|
|**genres**|The genres which describe this movie|MovieLens.org|
|**imdbId**|The imdb ID number that references this movie|MovieLens.org|
|**director**|The movie's director(s)|IMDB.com|
|**cast**|The movie's cast (first three billed)|IMDB.com|
|**short_summary**|A short summary of the movie|IMDB.com|
|**long_summary**|A long summary of the movie|IMDB.com|


The MovieLens 25M dataset may be downloaded at the following link: https://grouplens.org/datasets/movielens/

## Model Evaluation
All models were executed using code from the Surprise Library: http://surpriselib.com/

The metrics used to access our models were adapted from Surprise library FAQ:
1) RMSE
2) Precision @ k: Among all the recommended movies, what is the percentage of recommended movies that are above the threshold.
3) Recall @ k: Among all the movies above the treshold, how many of these are recommended?

Note from documentation (https://surprise.readthedocs.io/en/stable/FAQ.html):
- An item is considered relevant if its true rating is greater than a given threshold.
- An item is considered recommended if its estimated rating is greater than the threshold, and if it is among the k highest estimated ratings.

**Results:**

|Model|RMSE(train_set)|RMSE(test_set)|Precision@k(test_set)|Recall@k(test_set)|
|----------------:|------------:|------------:|------------:|------------:|
|**Normal**|1.484|1.485|0.735|0.493|
|**BaselineOnly**|0.760|0.792|0.563|0.231|
|**KNNBasic**|0.682|0.812|0.652|0.326|
|**KNNWithMeans**|0.683|0.801|0.635|0.373|
|**KNNWithMeans (optimized)**|NA|0.847|0.652|0.385|
|**KNNWithZScore**|0.675|0.798|0.608|0.341|
|**KNNBaseline**|0.658|0.780|0.658|0.329|
|**KNNBaseline (optimized)**|NA|0.818|0.685|0.373|
|**SVD**|0.592|0.786|0.596|0.275|
|**SVD (optimized)**|NA|0.852|0.646|0.329|
|**NMF**|0.668|0.801|0.616|0.318|
|**NMF (optimized)**|NA|0.857|0.730|0.563|
|**SlopeOne**|0.673|0.791|0.649|0.342|
|**CoClustering**|0.819|0.872|0.595|0.29|


The best model with a balance between accuracy, precision and recall was NMF. This model was selected for our movie recommender system.

## Key Findings

The full deployment of this movie recommendation engine development can be found at the following link: https://yeojiachi.wixsite.com/home/capstone

**1) A pure ratings based listing of movie recommendations for each user is not sustainable in the long term (Exploitation vs Exploration)**
- Given that users generally watch movies once, a recommended movie that is subsequently well received by the user is unlikely to be watched again (i.e., unable to be exploited further).
- As such, this movie recommendation system is optimised for user exploration using randomized selection within the top 30% percentiles of movie scores (see Jupyter notebook Section 11 for implementation).

**2) Choosing model tunability over accuracy**
- While KNN was found to be more accurate and conceptually more explainable, KNN suffers from low precision and recall.
- Importantly, KNN was can only be tuned on a single parameter (the number of k-nearest neighbours), whilst NMF can be tuned on the number of latent features and the item and user regularization parameters.
- As such, NMF was selected because of its superior precision and recall (i.e. more useful movie recommendations) with minimal loss of RMSE accuracy.

**3) Solving the cold-start problem through user-directed filtering**
- To deal with the cold-start problem, our movie recommender requires new users to initially choose within a list of recent and popular movies (see Jupyter notebook Section 12). This approach maximises the chance that a new user will enjoy something from this predefined list.
- This method allows the recommender system to immediately study this new user's browsing and movie viewing history for entry and batch calculations using the NMF model.


## Future Recommendations
Like always, further model improvements and website upgrades have to be made to improve our recommendation system.

1) Building a fully functional movie recommendation website
- While machine learning models are important for the building of a movie recommender system, this project also highlights the impact of a positive user experience. As such, significant effort has been dedicated towards making a functional movie recommendation web interface. 
- I expect future iterations of the website to include movie-trailer viewing and the logging of user viewing browing and viewing habits.

2) Inclusion of movie reviews without explicit movie scores
- As identified in the analysis (see Jupyter notebook Section 6), out of 775K movie reviews, approximately 230K of them have no explicit movie rating. While these unrated reviews were excluded for this project, they still nonetheless contain valuable movie information that would be extracted using NLP.
- For future iteration of this movie recommender, I envision that each movie would be rated based on its explicit rating (from 0 - 5), and a component based on the review sentiment.
- Using a combination of these 2 scores, NMF would then be applied to generate a list of user recommendations.

3) Receiving constant updates from internet movie databases
- An advantage of this movie recommendation system is that because we are not a video content provider, we are not limited to the types of movies which we can recommend to users.
- By collating the reviews of newly released movies, this movie recommendation system will allow for users to also receive customized recommendations for movies currently screening in cinemas. This is a feature that is currently unavailable on any online video streaming provider.
